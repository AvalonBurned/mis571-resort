.echo ON

.mode list
.separator "  |  "

.output resort.db

PRAGMA foreign_keys = ON;


CREATE TABLE Customer(
custID   INTEGER NOT NULL CONSTRAINT Customer_custId_pk PRIMARY KEY,
custFName VARCHAR(30) NOT NULL,
custLName VARCHAR(30)  NOT NULL,
custInitial VARCHAR(30),
custPhone VARCHAR(13) NOT NULL,
custUsername VARCHAR(20) NOT NULL,
custPassword VARCHAR(18) NOT NULL,
custPay VARCHAR(10) NOT NULL);

CREATE TABLE Booking(
bookID INTEGER CONSTRAINT booking_bookID_pk PRIMARY KEY,
bookCustID INTEGER CONSTRAINT Booking_bookCustID_fk REFERENCES Customer(custID),
bookSize INTEGER NOT NULL,
bookCheckIn DATE NOT NULL,
bookCheckOut DATE NOT NULL,
bookPrice DECIMAL(5,2) NOT NULL);

CREATE TABLE RoomType(
   typeRoomName		VARCHAR(12) CONSTRAINT RoomType_typeRoomName_pk PRIMARY KEY,
   typeDescription	VARCHAR(25)	NOT NULL,
   typePrice	DECIMAL(6,2) NOT NULL);

CREATE TABLE ResortRoom(
roomNum INTEGER CONSTRAINT ResortRoom_roomNum_pk PRIMARY KEY,
roomType VARCHAR(12) CONSTRAINT ResortRoom_roomType_fk REFERENCES RoomType(typeRoomName),
roomBookID INTGER CONSTRAINT ResortRoom_roomBookID_fk REFERENCES Booking(bookID));

CREATE TABLE Amenities(
amID INTEGER CONSTRAINT Amenities_amID_pk PRIMARY KEY,
amType VARCHAR(10) NOT NULL);

CREATE TABLE Spa(
spaID INTEGER CONSTRAINT spa_spaid_pk PRIMARY KEY,
spaPrice DECIMAL(6,2) NOT NULL,
spaAmID INTEGER CONSTRAINT Spa_amId_fk REFERENCES Amenities(amID),
spaDateTime DATE NOT NULL);

CREATE TABLE Restaurant(
resTableID INTEGER CONSTRAINT restaurant_restabid_pk PRIMARY KEY,
resFood VARCHAR(10) NOT NULL,
resAmID INTEGER CONSTRAINT Spa_amId_fk REFERENCES Amenities(amID),
resDateTime DATE NOT NULL);

CREATE TABLE Excursions(
excID INTEGER CONSTRAINT excursions_excid_pk PRIMARY KEY,
excType VARCHAR(15) NOT NULL,
excStarLocation VARCHAR(30) NOT NULL,
excDestination VARCHAR(30) NOT NULL,
excDateTime DATE NOT NULL,
excAmID CONSTRAINT exc_amId_fk REFERENCES Amenities(amID));

CREATE TABLE Tickets(
ticketID INTEGER CONSTRAINT ticket_id_pk PRIMARY KEY, 
ticketRoomnum INTEGER NOT NULL, 
ticketIssue VARCHAR(40) NOT NULL,
ticketcustID INTEGER CONSTRAINT tickets_custId_fk REFERENCES Customer(custID));

CREATE TABLE Orders(
orderID INTEGER CONSTRAINT orders_id_pk PRIMARY KEY, 
orderCustID INTEGER CONSTRAINT orders_custId_fk REFERENCES Customer(custID),
orderAmID INTEGER CONSTRAINT orders_AmId_fk REFERENCES Amenities(amID),
orderValue DECIMAL(7,2));

CREATE TABLE RoomBooking(
bookID INTEGER CONSTRAINT room_booking_bookId_fk REFERENCES Booking(bookID),
roomNum INTEGER CONSTRAINT room_booking_roomNum_fk REFERENCES ResortRoom(roomNum),
CONSTRAINT roomBooking_id_pk PRIMARY KEY(bookID,roomNum));

CREATE TABLE AmenityBooking(
orderID INTEGER CONSTRAINT order_custId_fk REFERENCES Orders(orderID),
amID INTEGER CONSTRAINT amenity_booking_AmId_fk REFERENCES Amenities(amID),
CONSTRAINT amenityBooking_id_pk PRIMARY KEY(orderID,amID));



.output stdout
.echo OFF

